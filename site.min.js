/*! project3 2017-06-23 */

function Game(e,t){var n=parse_json(t),s=n.game,o=this.setUpGameBoard(s);$(e).html(o);var a=this.setGame(s);this.installListeners(e,a,s,n)}function parse_json(e){try{var t=$.parseJSON(e)}catch(t){throw"JSON parse error: "+e}return t}Game.prototype.installListeners=function(e,t,n,s){var o=this;$(e+" td.cell button").click(function(s){s.preventDefault();var a=this.value.split(","),r=a[0],l=a[1],c="td_"+r+"_"+l,d=document.getElementById(c);0===t[r][l]?($(d).removeClass("none"),$(d).removeClass("bad"),$(d).addClass("sea"),t[r][l]=-1):-1===t[r][l]?($(d).removeClass("sea"),$(d).removeClass("bad"),$(d).addClass("none"),this.innerHTML="&#9679;",t[r][l]=-2):-2===t[r][l]&&($(d).removeClass("bad"),this.innerHTML="&nbsp;",t[r][l]=0),o.checkWin(t,n)&&($(e).html(o.showSolution(n)),document.getElementById("message").innerHTML="You're a winner!",$(document.getElementById("message")).show())}),$(e+" .gamebuttons .check").click(function(e){e.preventDefault(),o.checkSolution(t,n)}),$(e+" .gamebuttons .solve").click(function(s){s.preventDefault(),$(e+" .gamebuttons").hide(),$(e+" .yesno").show(),o.removeErrors(t,n)}),$(e+" .gamebuttons .clear").click(function(s){s.preventDefault(),o.clearGame(t);var a=o.setUpGameBoard(n);$(e).html(a);var r=o.setGame(n);o.installListeners(e,r,n)}),$(e+" .yesno .yes").click(function(t){t.preventDefault(),$(e+" .yesno").hide(),$(e).html(o.showSolution(n)),document.getElementById("message").innerHTML="You're a winner!",$(document.getElementById("message")).show()}),$(e+" .yesno .no").click(function(t){t.preventDefault(),$(e+" .gamebuttons").show(),$(e+" .yesno").hide()})},Game.prototype.setUpGameBoard=function(e){for(var t='<table class="game">',n=0;n<e.length;n++){t+="<tr>";for(var s=0;s<e[n].length;s++)-1===e[n][s]||-2===e[n][s]?t+='<td class="cell none" id="td_'+n+"_"+s+'"><button name="cell" value="'+n+","+s+'">&nbsp;</button></td>':t+='<td class="cell none" id="td_'+n+"_"+s+'">'+e[n][s]+"</td>";t+="</tr>"}return t+="</table>",t+='<div class="gamebuttons"><p><button class="check">Check Solution</button> <button class="solve">Solve</button> <button class="clear">Clear</button></p></div>',t+='<div class="yesno" style="display:none"><p><br><button class="yes">Yes</button> <button class="no">No</button></p><br><p class="message">Are you sure you want to solve?</p></div>',t+='<div><br><p id="message"></p></div>'},Game.prototype.setGame=function(e){for(var t=[],n=0;n<e.length;n++){t.push([]);for(var s=0;s<e[n].length;s++)-1===e[n][s]||-2===e[n][s]?t[n].push(0):t[n].push(e[n][s])}return t},Game.prototype.checkWin=function(e,t){for(var n=0;n<e.length;n++)for(var s=0;s<e[n].length;s++)if(e[n][s]!==t[n][s])return!1;return!0},Game.prototype.showSolution=function(e){for(var t='<table class="game">',n=0;n<e.length;n++){t+="<tr>";for(var s=0;s<e[n].length;s++)-1===e[n][s]?t+='<td class="cell sea" id="td_'+n+"_"+s+'">&nbsp;</td>':-2===e[n][s]?t+='<td class="cell none" id="td_'+n+"_"+s+'">&#9679;</td>':t+='<td class="cell none" id="td_'+n+"_"+s+'">'+e[n][s]+"</td>";t+="</tr>"}return t+='</table><div><br><p id="message"></p></div>'},Game.prototype.clearGame=function(e){for(var t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++)-1!==e[t][n]&&-2!==e[t][n]||(e[t][n]=0)},Game.prototype.checkSolution=function(e,t){for(var n=0;n<e.length;n++)for(var s=0;s<e[n].length;s++){var o="td_"+n+"_"+s,a=document.getElementById(o);e[n][s]!==t[n][s]&&0!==e[n][s]&&($(a).removeClass("none"),$(a).removeClass("sea"),$(a).addClass("bad"))}},Game.prototype.removeErrors=function(e,t){for(var n=0;n<e.length;n++)for(var s=0;s<e[n].length;s++){var o="td_"+n+"_"+s,a=document.getElementById(o);e[n][s]!==t[n][s]&&0!==e[n][s]&&($(a).removeClass("bad"),-1===e[n][s]?$(a).addClass("sea"):-2===e[n][s]&&$(a).addClass("none"))}};